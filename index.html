<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FVG Signals">
    <title>FVG Trading Signals</title>
    <link rel="manifest" href="manifest.json">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overscroll-behavior: none;
            -webkit-tap-highlight-color: transparent;
        }
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        input, textarea {
            -webkit-user-select: text;
            user-select: text;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lucide icons as components
        const Activity = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
        );
        
        const TrendingUp = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );
        
        const TrendingDown = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
                <polyline points="17 18 23 18 23 12"></polyline>
            </svg>
        );
        
        const Settings = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m0-18a9 9 0 0 1 9 9m-18 0a9 9 0 0 1 9-9"></path>
            </svg>
        );
        
        const Bell = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
        );
        
        const Play = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
        );
        
        const Pause = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="6" y="4" width="4" height="16"></rect>
                <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
        );
        
        const AlertCircle = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        function TradingSignalApp() {
            const [isRunning, setIsRunning] = useState(false);
            const [signals, setSignals] = useState([]);
            const [config, setConfig] = useState({
                symbol: 'BTC/USDT',
                timeframe: '15m',
                exchange: 'binance',
                webhookUrl: '',
                interval: 60
            });
            const [showConfig, setShowConfig] = useState(false);
            const [stats, setStats] = useState({
                totalSignals: 0,
                bullishSignals: 0,
                bearishSignals: 0,
                lastCheck: null
            });

            // Load saved config and signals from localStorage
            useEffect(() => {
                const savedConfig = localStorage.getItem('tradingBotConfig');
                const savedSignals = localStorage.getItem('tradingBotSignals');
                const savedStats = localStorage.getItem('tradingBotStats');
                
                if (savedConfig) setConfig(JSON.parse(savedConfig));
                if (savedSignals) setSignals(JSON.parse(savedSignals));
                if (savedStats) setStats(JSON.parse(savedStats));
            }, []);

            // Save to localStorage
            useEffect(() => {
                localStorage.setItem('tradingBotConfig', JSON.stringify(config));
            }, [config]);

            useEffect(() => {
                localStorage.setItem('tradingBotSignals', JSON.stringify(signals));
            }, [signals]);

            useEffect(() => {
                localStorage.setItem('tradingBotStats', JSON.stringify(stats));
            }, [stats]);

            // Simulate bot analysis
            useEffect(() => {
                if (!isRunning) return;

                const interval = setInterval(() => {
                    setStats(prev => ({
                        ...prev,
                        lastCheck: new Date().toLocaleTimeString()
                    }));

                    // Simulate occasional signal generation (20% chance)
                    if (Math.random() < 0.2) {
                        generateMockSignal();
                    }
                }, config.interval * 1000);

                return () => clearInterval(interval);
            }, [isRunning, config.interval]);

            const generateMockSignal = () => {
                const isBullish = Math.random() > 0.5;
                const basePrice = config.symbol === 'BTC/USDT' ? 45000 : 2500;
                const variance = basePrice * 0.02;
                const currentPrice = basePrice + (Math.random() - 0.5) * variance * 2;
                
                const signal = {
                    id: Date.now(),
                    type: isBullish ? 'bullish' : 'bearish',
                    symbol: config.symbol,
                    timeframe: config.timeframe,
                    timestamp: new Date().toISOString(),
                    currentPrice: currentPrice,
                    fvgTop: isBullish ? currentPrice * 1.015 : currentPrice * 1.005,
                    fvgBottom: isBullish ? currentPrice * 0.995 : currentPrice * 0.985,
                    swingPoint: isBullish ? currentPrice * 0.99 : currentPrice * 1.01,
                    entryZone: isBullish ? currentPrice * 0.995 : currentPrice * 1.005,
                    stopLoss: isBullish ? currentPrice * 0.985 : currentPrice * 1.015,
                    tp1: isBullish ? currentPrice * 1.015 : currentPrice * 0.985,
                    tp2: isBullish ? currentPrice * 1.035 : currentPrice * 0.965,
                    riskReward: 2.5 + Math.random() * 1.5
                };

                setSignals(prev => [signal, ...prev].slice(0, 20));
                setStats(prev => ({
                    totalSignals: prev.totalSignals + 1,
                    bullishSignals: prev.bullishSignals + (isBullish ? 1 : 0),
                    bearishSignals: prev.bearishSignals + (isBullish ? 0 : 1),
                    lastCheck: prev.lastCheck
                }));
            };

            const toggleBot = () => {
                if (!config.webhookUrl && !isRunning) {
                    alert('Please configure Discord webhook URL first');
                    setShowConfig(true);
                    return;
                }
                setIsRunning(!isRunning);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900">
                    <div className="bg-slate-800/50 backdrop-blur-sm border-b border-slate-700">
                        <div className="max-w-md mx-auto px-4 py-4">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-3">
                                    <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center">
                                        <Activity />
                                    </div>
                                    <div>
                                        <h1 className="text-lg font-bold text-white">FVG Signals</h1>
                                        <p className="text-xs text-slate-400">{config.symbol} â€¢ {config.timeframe}</p>
                                    </div>
                                </div>
                                <button
                                    onClick={() => setShowConfig(!showConfig)}
                                    className="w-10 h-10 bg-slate-700/50 rounded-lg flex items-center justify-center hover:bg-slate-700 transition-colors"
                                >
                                    <Settings />
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-md mx-auto px-4 py-4 space-y-4">
                        <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-4 border border-slate-700">
                            <div className="flex items-center justify-between mb-4">
                                <div className="flex items-center gap-2">
                                    <div className={`w-3 h-3 rounded-full ${isRunning ? 'bg-green-500 animate-pulse' : 'bg-slate-600'}`} />
                                    <span className="text-sm font-medium text-slate-300">
                                        {isRunning ? 'Bot Running' : 'Bot Stopped'}
                                    </span>
                                </div>
                                <button
                                    onClick={toggleBot}
                                    className={`px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-all ${
                                        isRunning
                                            ? 'bg-red-500/20 text-red-400 hover:bg-red-500/30'
                                            : 'bg-green-500/20 text-green-400 hover:bg-green-500/30'
                                    }`}
                                >
                                    {isRunning ? <><Pause /> Stop</> : <><Play /> Start</>}
                                </button>
                            </div>

                            <div className="grid grid-cols-3 gap-3">
                                <div className="bg-slate-700/30 rounded-lg p-3 text-center">
                                    <div className="text-2xl font-bold text-white">{stats.totalSignals}</div>
                                    <div className="text-xs text-slate-400 mt-1">Total Signals</div>
                                </div>
                                <div className="bg-green-500/10 rounded-lg p-3 text-center">
                                    <div className="text-2xl font-bold text-green-400">{stats.bullishSignals}</div>
                                    <div className="text-xs text-slate-400 mt-1">Bullish</div>
                                </div>
                                <div className="bg-red-500/10 rounded-lg p-3 text-center">
                                    <div className="text-2xl font-bold text-red-400">{stats.bearishSignals}</div>
                                    <div className="text-xs text-slate-400 mt-1">Bearish</div>
                                </div>
                            </div>

                            {stats.lastCheck && (
                                <div className="mt-3 text-xs text-slate-500 text-center">
                                    Last check: {stats.lastCheck}
                                </div>
                            )}
                        </div>

                        {showConfig && (
                            <div className="bg-slate-800/50 backdrop-blur-sm rounded-2xl p-4 border border-slate-700 space-y-3">
                                <h3 className="font-semibold text-white mb-3">Configuration</h3>
                                
                                <div>
                                    <label className="block text-xs text-slate-400 mb-1">Trading Pair</label>
                                    <select
                                        value={config.symbol}
                                        onChange={(e) => setConfig({...config, symbol: e.target.value})}
                                        className="w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm"
                                    >
                                        <option value="BTC/USDT">BTC/USDT</option>
                                        <option value="ETH/USDT">ETH/USDT</option>
                                        <option value="BNB/USDT">BNB/USDT</option>
                                        <option value="SOL/USDT">SOL/USDT</option>
                                    </select>
                                </div>

                                <div>
                                    <label className="block text-xs text-slate-400 mb-1">Timeframe</label>
                                    <select
                                        value={config.timeframe}
                                        onChange={(e) => setConfig({...config, timeframe: e.target.value})}
                                        className="w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm"
                                    >
                                        <option value="1m">1 Minute</option>
                                        <option value="5m">5 Minutes</option>
                                        <option value="15m">15 Minutes</option>
                                        <option value="30m">30 Minutes</option>
                                        <option value="1h">1 Hour</option>
                                        <option value="4h">4 Hours</option>
                                    </select>
                                </div>

                                <div>
                                    <label className="block text-xs text-slate-400 mb-1">Check Interval (seconds)</label>
                                    <input
                                        type="number"
                                        value={config.interval}
                                        onChange={(e) => setConfig({...config, interval: parseInt(e.target.value) || 60})}
                                        className="w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm"
                                        min="5"
                                    />
                                </div>

                                <div>
                                    <label className="block text-xs text-slate-400 mb-1">Discord Webhook URL</label>
                                    <input
                                        type="text"
                                        value={config.webhookUrl}
                                        onChange={(e) => setConfig({...config, webhookUrl: e.target.value})}
                                        placeholder="https://discord.com/api/webhooks/..."
                                        className="w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-white text-sm"
                                    />
                                </div>

                                <button
                                    onClick={() => setShowConfig(false)}
                                    className="w-full bg-blue-500/20 text-blue-400 rounded-lg py-2 font-medium hover:bg-blue-500/30 transition-colors"
                                >
                                    Save Configuration
                                </button>
                            </div>
                        )}

                        <div className="space-y-3">
                            <div className="flex items-center justify-between">
                                <h3 className="font-semibold text-white">Recent Signals</h3>
                                <Bell />
                            </div>

                            {signals.length === 0 ? (
                                <div className="bg-slate-800/30 rounded-2xl p-8 text-center border border-slate-700/50">
                                    <AlertCircle />
                                    <p className="text-slate-500 text-sm mt-3">No signals yet</p>
                                    <p className="text-slate-600 text-xs mt-1">Start the bot to receive trading signals</p>
                                </div>
                            ) : (
                                signals.map((signal) => (
                                    <div
                                        key={signal.id}
                                        className={`rounded-2xl p-4 border ${
                                            signal.type === 'bullish'
                                                ? 'bg-green-500/5 border-green-500/20'
                                                : 'bg-red-500/5 border-red-500/20'
                                        }`}
                                    >
                                        <div className="flex items-start justify-between mb-3">
                                            <div className="flex items-center gap-2">
                                                {signal.type === 'bullish' ? <TrendingUp /> : <TrendingDown />}
                                                <div>
                                                    <span className={`font-semibold ${signal.type === 'bullish' ? 'text-green-400' : 'text-red-400'}`}>
                                                        {signal.type.toUpperCase()} SIGNAL
                                                    </span>
                                                    <p className="text-xs text-slate-500">
                                                        {new Date(signal.timestamp).toLocaleTimeString()}
                                                    </p>
                                                </div>
                                            </div>
                                            <span className="text-xs bg-slate-700/50 px-2 py-1 rounded text-slate-300">
                                                {signal.timeframe}
                                            </span>
                                        </div>

                                        <div className="grid grid-cols-2 gap-3 text-xs">
                                            <div>
                                                <span className="text-slate-500">Current Price</span>
                                                <div className="text-white font-semibold">${signal.currentPrice.toFixed(2)}</div>
                                            </div>
                                            <div>
                                                <span className="text-slate-500">Entry Zone</span>
                                                <div className="text-white font-semibold">${signal.entryZone.toFixed(2)}</div>
                                            </div>
                                            <div>
                                                <span className="text-slate-500">Stop Loss</span>
                                                <div className="text-red-400 font-semibold">${signal.stopLoss.toFixed(2)}</div>
                                            </div>
                                            <div>
                                                <span className="text-slate-500">Take Profit 1</span>
                                                <div className="text-green-400 font-semibold">${signal.tp1.toFixed(2)}</div>
                                            </div>
                                            <div>
                                                <span className="text-slate-500">Take Profit 2</span>
                                                <div className="text-green-400 font-semibold">${signal.tp2.toFixed(2)}</div>
                                            </div>
                                            <div>
                                                <span className="text-slate-500">Risk:Reward</span>
                                                <div className="text-blue-400 font-semibold">1:{signal.riskReward.toFixed(2)}</div>
                                            </div>
                                        </div>

                                        <div className="mt-3 pt-3 border-t border-slate-700/50">
                                            <div className="flex items-center justify-between text-xs">
                                                <span className="text-slate-500">FVG Zone</span>
                                                <span className="text-slate-400">
                                                    ${signal.fvgBottom.toFixed(2)} - ${signal.fvgTop.toFixed(2)}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<TradingSignalApp />, document.getElementById('root'));
    </script>

    <script>
        // Register service worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed'));
            });
        }
    </script>
</body>
</html>
